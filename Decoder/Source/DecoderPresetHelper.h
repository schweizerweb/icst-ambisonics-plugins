/*
  ==============================================================================

    DecoderPresetHelper.h
    Created: 26 Jan 2020 9:49:43pm
    Author:  Schweizer Christian

  ==============================================================================
*/

#pragma once
#include "../../Common/PresetHelper.h"
#include "../../Common/TrackColors.h"

#define DEFAULT_PRESET_NAME "Standard - Stereo 90deg"

class DecoderPresetHelper : public PresetHelper
{
public:
    DecoderPresetHelper(File presetDirectory, ActionListener* pActionListener, ScalingInfo* pScaling) : PresetHelper(presetDirectory, pActionListener), pScalingInfo(pScaling)
    {
    }

    struct SSpeaker
    {
        double x;
        double y;
        double z;
        String name;
        bool isSubwoofer = false;
        int colorIndex = 0;
    };

    bool checkValid(juce::File presetFile) override
    {
        std::unique_ptr<AmbiSpeakerSet> testSet(new AmbiSpeakerSet(pScalingInfo));
        AmbiSettings testSettings;
        if(loadFromXmlFile(presetFile, testSet.get(), &testSettings))
        {
            return true;
        }
        
        return false;
    }
    
    void restoreDefaultsInternal() override
    {
        const double cos30 = 0.8660253882408143;
        const double sin45 = 0.7071067811865475;
        
		createPreset("Regular 3D - Hexagon", {
			{ -0.5, cos30, 0, "1"},
			{ 0.5, cos30, 0, "2"},
			{ 1, 0, 0, "3"},
			{ 0.5, -cos30, 0, "4"},
			{ -0.5, -cos30, 0, "5"},
			{ -1, 0, 0, "6"},
			{ 0, sin45, sin45, "7", false, 1},
			{ 0.612372, 0.353553, sin45, "8", false, 1},
			{ 0.612372, -0.353553, sin45, "9", false, 1},
			{ 0, -sin45, sin45, "10", false, 1},
			{ -0.612372, -0.353553, sin45, "11", false, 1},
			{ -0.612372, 0.353553, sin45, "12", false, 1}
			});

		createPreset("Dolby 4.0", {
			{ -0.5, cos30, 0, "L"},
			{ 0.5, cos30, 0, "R"},
			{ -0.829399, -0.301877, 0, "SL"},
			{ 0.939693, -0.34202, 0, "SR"}
			});

		createPreset("Dolby 5.0 Film", {
			{ -0.5, cos30, 0, "L"},
			{ 0, 1, 0, "C"},
			{ 0.5, cos30, 0, "R"},
			{ -0.939693, -0.34202, 0, "SL"},
			{ 0.939693, -0.34202, 0, "SR"}
			});

		createPreset("Dolby 5.0 ITU", {
			{ -0.5, cos30, 0, "L"},
			{ 0.5, cos30, 0, "R"},
			{ 0, 1, 0, "C"},
			{ -0.939693, -0.34202, 0, "SL"},
			{ 0.939693, -0.34202, 0, "SR"}
			});

		createPreset("Dolby 5.1 Film", {
			{ -0.5, cos30, 0, "L"},
			{ 0, 1, 0, "C"},
			{ 0.5, cos30, 0, "R"},
			{ -0.939693, -0.34202, 0, "SL"},
			{ 0.939693, -0.34202, 0, "SR"},
			{ 0.258819, 0.965926, 0, "LFE", true}
			});

		createPreset("Dolby 5.1 ITU", {
			{ -0.5, cos30, 0, "L"},
			{ 0.5, cos30, 0, "R"},
			{ 0, 1, 0, "C"},
			{ 0.25, 0.933013, -0.258819, "LFE", true},
			{ -0.939693, -0.34202, 0, "SL"},
			{ 0.939693, -0.34202, 0, "SR"}
			});

		createPreset("Dolby 6.0", {
			{ -0.5, cos30, 0, "L"},
			{ 0.5, cos30, 0, "R"},
			{ 0, 1, 0, "C"},
			{ -0.939693, -0.34202, 0, "SL"},
			{ 0.939693, -0.34202, 0, "SR"},
			{ 0, -1, 0, "BC"}
			});

		createPreset("Dolby 6.1", {
			{ -0.5, cos30, 0, "L"},
			{ 0.5, cos30, 0, "R"},
			{ 0, 1, 0, "C"},
			{ 0.25, 0.933013, -0.258819, "LFE", true},
			{ -0.939693, -0.34202, 0, "SL"},
			{ 0.939693, -0.34202, 0, "SR"},
			{ 0, -1, 0, "BC"}
			});

		createPreset("Dolby 7.0", {
			{ -0.5, cos30, 0, "L"},
			{ 0.5, cos30, 0, "R"},
			{ 0, 1, 0, "C"},
			{ -1, 0, 0, "SSL"},
			{ 1, 0, 0, "SSR"},
			{ -0.642788, -0.766044, 0, "SBL"},
			{ sin45, -sin45, 0, "SBR"}
			});

		createPreset("Dolby 7.1", {
			{ -0.5, cos30, 0, "L"},
			{ 0.5, cos30, 0, "R"},
			{ 0, 1, 0, "C"},
			{ 0.25, 0.933013, -0.258819, "LFE", true},
			{ -1, 0, 0, "SSL"},
			{ 1, 0, 0, "SSR"},
			{ -0.642788, -0.766044, 0, "SBL"},
			{ sin45, -sin45, 0, "SBR"}
			});
        
        createPreset("Dolby Atmos 5.0.2", {
            { -0.5000000000000001, 0.8660253882408143, 0.0, "L" },
            { 0.5000000000000001, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { -0.939693, -0.34202, 0.0, "SL" },
            { 0.939693, -0.34202, 0.0, "SR" },
            { -0.6963639999999999, 0.122788, 0.7071067811865475, "HFL", false, 1 },
            { 0.6963639999999999, 0.122788, 0.7071067811865475, "HFR", false, 1 }
        });

        createPreset("Dolby Atmos 5.0.4", {
            { -0.5000000000000001, 0.8660253882408143, 0.0, "L" },
            { 0.5000000000000001, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { -0.939693, -0.34202, 0.0, "SL" },
            { 0.939693, -0.34202, 0.0, "SR" },
            { -0.6963639999999999, 0.122788, 0.7071067811865475, "HFL", false, 1 },
            { 0.6963639999999999, 0.122788, 0.7071067811865475, "HFR", false, 1 },
            { -0.6644629999999999, -0.241845, 0.7071067811865475, "HBL", false, 1 },
            { 0.6644629999999999, -0.241845, 0.7071067811865475, "HBR", false, 1 }
        });
        
        createPreset("Dolby Atmos 5.1.2", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { 0.25, 0.933013, -0.258819, "LFE", true },
            { -0.939693, -0.34202, 0.0, "SL" },
            { 0.939693, -0.34202, 0.0, "SR" },
            { -0.6963639999999999, 0.122788, 0.7071067811865475, "LC", false, 1 },
            { 0.6963639999999999, 0.122788, 0.7071067811865475, "RC", false, 1 }
        });
        
        createPreset("Dolby Atmos 5.1.4", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { 0.25, 0.933013, -0.258819, "LFE", true },
            { -0.939693, -0.34202, 0.0, "SL" },
            { 0.939693, -0.34202, 0.0, "SR" },
            { -0.5, 0.5, 0.7071067811865475, "HFL", false, 1 },
            { 0.5, 0.5, 0.7071067811865475, "HFR", false, 1 },
            { -0.5, -0.5, 0.7071067811865475, "HBL", false, 1 },
            { 0.5, -0.5, 0.7071067811865475, "HBR", false, 1 }
        });
        
        createPreset("Dolby Atmos 7.0.2", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { -1.0, 0.0, 0.0, "SL" },
            { 1.0, 0.0, 0.0, "SR" },
            { -0.7071067811865475, -0.7071067811865475, 0.0, "SBL" },
            { 0.7071067811865475, -0.7071067811865475, 0.0, "SBR" },
            { -0.6963639999999999, 0.122788, 0.7071067811865475, "TL", false, 1 },
            { 0.6963639999999999, 0.122788, 0.7071067811865475, "TR", false, 1 }
        });
        
        createPreset("Dolby Atmos 7.0.4", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { -1.0, 0.0, 0.0, "SL" },
            { 1.0, 0.0, 0.0, "SR" },
            { -0.7071067811865475, -0.7071067811865475, 0.0, "SBL" },
            { 0.7071067811865475, -0.7071067811865475, 0.0, "SBR" },
            { -0.353553, 0.612372, 0.7071067811865475, "HFL", false, 1 },
            { 0.353553, 0.612372, 0.7071067811865475, "HFR", false, 1 },
            { -0.5, -0.5, 0.7071067811865475, "HBL", false, 1 },
            { 0.5, -0.5, 0.7071067811865475, "HBR", false, 1 }
        });
        
        createPreset("Dolby Atmos 7.1.2", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { 0.25, 0.933013, -0.258819, "LFE", true },
            { -1.0, 0.0, 0.0, "SSL" },
            { 1.0, 0.0, 0.0, "SSR" },
            { -0.939693, -0.34202, 0.0, "SL" },
            { 0.939693, -0.34202, 0.0, "SR" },
            { -0.6963639999999999, 0.122788, 0.7071067811865475, "TL", false, 1 },
            { 0.6963639999999999, 0.122788, 0.7071067811865475, "TR", false, 1 }
        });
        
        createPreset("Dolby Atmos 7.1.4", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { 0.25, 0.9330130000000001, -0.2928202719998737, "LFE", true },
            { -0.5, -0.8660253882408144, 0.0, "SBL" },
            { 0.5, -0.8660253882408144, 0.0, "SBR" },
            { -1.0, 0.0, 0.0, "SSL" },
            { 1.0, 0.0, 0.0, "SSR" },
            { -0.5, 0.5, 0.8, "HFL", false, 1 },
            { 0.5, 0.5, 0.8, "HFC", false, 1 },
            { -0.5, -0.5, 0.8, "HRL", false, 1 },
            { 0.5, -0.5, 0.8, "HBR", false, 1 }
        });
        
        createPreset("Dolby Atmos 8.0", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { -0.939693, -0.34202, 0.0, "SL" },
            { 0.939693, -0.34202, 0.0, "SR" },
            { -0.4330129999999999, 0.7499999999999999, 0.5, "HFL", false, 1 },
            { 0.4330129999999999, 0.7499999999999999, 0.5, "HFR", false, 1 },
            { -0.813798, -0.296198, 0.5, "HBL" },
            { 0.813798, -0.296198, 0.5, "HBR" }
        });
        
        createPreset("Dolby Atmos 9.1.2", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { 0.25, 0.933013, -0.258819, "LFE", true },
            { -1.0, 0.0, 0.0, "SL" },
            { 1.0, 0.0, 0.0, "SR" },
            { -0.7071067811865475, -0.7071067811865475, 0.0, "SBL" },
            { 0.7071067811865475, -0.7071067811865475, 0.0, "SBR" },
            { -0.8660253882408143, 0.5, 0.0, "SSL" },
            { 0.8660253882408143, 0.5, 0.0, "SSR" },
            { -0.6963639999999999, 0.122788, 0.7071067811865475, "TL", false, 1 },
            { 0.6963639999999999, 0.122788, 0.7071067811865475, "TR", false, 1 }
        });
        
        createPreset("Dolby Atmos 9.1.6", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { 0.25, 0.933013, -0.258819, "LFE", true },
            { -0.939693, -0.34202, 0.0, "SL" },
            { 0.939693, -0.34202, 0.0, "SR" },
            { -0.4330129999999999, 0.75, 0.5, "HFL", false, 1 },
            { 0.4330129999999999, 0.75, 0.5, "HFR", false, 1 },
            { -0.813798, -0.296198, 0.5, "HBL", false, 1 },
            { 0.813798, -0.296198, 0.5, "HBR", false, 1 }
        });
        
        createPreset("Dolby Atmos 9.1", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { 0.25, 0.933013, -0.258819, "LFE", true },
            { -0.939693, -0.34202, 0.0, "SL" },
            { 0.939693, -0.34202, 0.0, "SR" },
            { -0.4330129999999999, 0.75, 0.5, "HFL", false, 1 },
            { 0.4330129999999999, 0.75, 0.5, "HFR", false, 1 },
            { -0.813798, -0.296198, 0.5, "HBL", false, 1 },
            { 0.813798, -0.296198, 0.5, "HBR", false, 1 }
        });
        
        createPreset("Dolby Atmos 10.2", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { -0.939693, -0.34202, 0.0, "LS" },
            { 0.939693, -0.34202, 0.0, "RS" },
            { -0.8191519999999998, 0.573576, 0.0, "LW" },
            { 0.8191519999999998, 0.573576, 0.0, "RW" },
            { 0.0, -0.7071067811865475, 0.7071067811865475, "BS" },
            { -0.5, 0.5, 0.7071067811865475, "LH" },
            { 0.5, 0.5, 0.7071067811865475, "RH" },
            { -0.965926, 0.0, -0.258819, "LFE-L", true },
            { 0.965926, 0.0, -0.258819, "LFE-R", true }
        });
        
        createPreset("Dolby Atmos 11.1", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { 0.25, 0.933013, -0.258819, "LFE", true },
            { -0.939693, -0.34202, 0.0, "SL" },
            { 0.939693, -0.34202, 0.0, "SR" },
            { 0.0, 0.0, 1.0, "T", false, 2 },
            { -0.4330129999999999, 0.75, 0.5, "HFL", false, 1 },
            { 0.0, 0.8660253882408143, 0.5, "HFC", false, 1 },
            { 0.4330129999999999, 0.75, 0.5, "HFR", false, 1 },
            { -0.813798, -0.296198, 0.5, "HBL", false, 1 },
            { 0.813798, -0.296198, 0.5, "HBR", false, 1 }
        });
        
        createPreset("Dolby Atmos 13.1", {
            { -0.5, 0.8660253882408143, 0.0, "L" },
            { 0.5, 0.8660253882408143, 0.0, "R" },
            { 0.0, 1.0, 0.0, "C" },
            { 0.25, 0.933013, -0.258819, "LFE", true },
            { -0.5, -0.8660253882408143, 0.0, "SBL" },
            { 0.5, -0.8660253882408143, 0.0, "SBR" },
            { -0.939693, -0.34202, 0.0, "SL" },
            { 0.939693, -0.34202, 0.0, "SR" },
            { 0.0, 0.0, 1.0, "T", false, 2 },
            { -0.4330129999999999, 0.75, 0.5, "HFL", false, 1 },
            { 0.0, 0.8660253882408143, 0.5, "HFC", false, 1 },
            { 0.4330129999999999, 0.75, 0.5, "HFR", false, 1 },
            { -0.813798, -0.296198, 0.5, "HBL", false, 1 },
            { 0.813798, -0.296198, 0.5, "HBR", false, 1 }
        });
        
        createPreset("Dolby Atmos 22.2", {
            { -0.8365160000000001, 0.482963, 0.258819, "MFL" },
            { -0.482963, 0.8365160000000001, 0.258819, "MFL/C" },
            { 0.0, 0.965926, 0.258819, "MFC" },
            { 0.482963, 0.8365160000000001, 0.258819, "MFC/R" },
            { 0.8365160000000001, 0.482963, 0.258819, "MFR" },
            { -0.965926, 0.0, 0.258819, "MSL" },
            { 0.965926, 0.0, 0.258819, "MSR" },
            { -0.620885, -0.739942, 0.258819, "MBL" },
            { 0.0, -0.965926, 0.258819, "MBC" },
            { 0.6830129999999999, -0.6830129999999999, 0.258819, "MBR" },
            { -0.612372, 0.353553, 0.7071067811865475, "UFL", false, 1 },
            { 0.0, 0.7071067811865475, 0.7071067811865475, "UFC", false, 1 },
            { 0.612372, 0.353553, 0.7071067811865475, "UFR", false, 1 },
            { -0.7071067811865475, 0.0, 0.7071067811865475, "USL", false, 1 },
            { 0.0, 0.0, 1.0, "USC", false, 2 },
            { 0.7071067811865475, 0.0, 0.7071067811865475, "USR", false, 1 },
            { -0.454519, -0.541675, 0.7071067811865475, "UBL", false, 1 },
            { 0.0, -0.7071067811865475, 0.7071067811865475, "UBC", false, 1 },
            { 0.5, -0.5, 0.7071067811865475, "UBR", false, 1 },
            { -0.8365160000000001, 0.482963, -0.258819, "LFL", false, 2 },
            { 0.0, 0.965926, -0.258819, "LFC", false, 2 },
            { 0.482963, 0.8365160000000001, -0.258819, "LFR", false, 2 },
            { -0.965926, 0.0, -0.258819, "LFE-L", true },
            { 0.965926, 0.0, -0.258819, "LFE-R", true }
        });
        
		createPreset("Regular 3D - Cube A", {
			{ -sin45, sin45, 0, "1"},
			{ sin45, sin45, 0, "2"},
			{ sin45, -sin45, 0, "3"},
			{ -sin45, -sin45, 0, "4"},
			{ -0.5, 0.5, sin45, "5", false, 1},
			{ 0.5, 0.5, sin45, "6", false, 1},
			{ 0.5, -0.5, sin45, "7", false, 1},
			{ -0.5, -0.5, sin45, "8", false, 1}
			});

		createPreset("Regular 3D - Cube B", {
			{ -sin45, sin45, 0, "1"},
			{ sin45, sin45, 0, "2"},
			{ sin45, -sin45, 0, "3"},
			{ -sin45, -sin45, 0, "4"},
			{ 0, sin45, sin45, "5", false, 1},
			{ sin45, 0, sin45, "6", false, 1},
			{ 0, -sin45, sin45, "7", false, 1},
			{ -sin45, 0, sin45, "8", false, 1}
			});

		createPreset("Regular 2D - Dodecagon", {
			{ -0.5, cos30, 0, "1"},
			{ 0, 1, 0, "2"},
			{ 0.5, cos30, 0, "3"},
			{ cos30, 0.5, 0, "4"},
			{ 1, 0, 0, "5"},
			{ cos30, -0.5, 0, "6"},
			{ 0.5, -cos30, 0, "7"},
			{ 0, -1, 0, "8"},
			{ -0.5, -cos30, 0, "9"},
			{ -cos30, -0.5, 0, "10"},
			{ -1, 0, 0, "11"},
			{ -cos30, 0.5, 0, "12"}
			});

		createPreset("Regular 3D - Dome", {
			{ -0.382683, 0.92388, 0, "1"},
			{ 0.382683, 0.92388, 0, "2"},
			{ 0.92388, 0.382683, 0, "3"},
			{ 0.92388, -0.382683, 0, "4"},
			{ 0.382683, -0.92388, 0, "5"},
			{ -0.382683, -0.92388, 0, "6"},
			{ -0.92388, -0.382683, 0, "7"},
			{ -0.92388, 0.382683, 0, "8"},
			{ 0, sin45, sin45, "9", false, 1},
			{ 0.5, 0.5, sin45, "10", false, 1},
			{ sin45, 0, sin45, "11", false, 1},
			{ 0.5, -0.5, sin45, "12", false, 1},
			{ 0, -sin45, sin45, "13", false, 1},
			{ -0.5, -0.5, sin45, "14", false, 1},
			{ -sin45, 0, sin45, "15", false, 1},
			{ -0.5, 0.5, sin45, "16", false, 1},
			{ 0, 0, 1, "T", false, 2}
			});

		createPreset("Regular 2D - Hexadecagon (16)", {
			{ -0.19509, 0.980785, 0, "1"},
			{ 0.19509, 0.980785, 0, "2"},
			{ 0.55557, 0.83147, 0, "3"},
			{ 0.83147, 0.55557, 0, "4"},
			{ 0.980785, 0.19509, 0, "5"},
			{ 0.980785, -0.19509, 0, "6"},
			{ 0.831469, -0.55557, 0, "7"},
			{ 0.55557, -0.83147, 0, "8"},
			{ 0.19509, -0.980785, 0, "9"},
			{ -0.195091, -0.980785, 0, "10"},
			{ -0.55557, -0.831469, 0, "11"},
			{ -0.83147, -0.55557, 0, "12"},
			{ -0.980785, -0.19509, 0, "13"},
			{ -0.980785, 0.195091, 0, "14"},
			{ -0.831469, 0.55557, 0, "15"},
			{ -0.55557, 0.83147, 0, "16"}
			});

		createPreset("Regular 2D - Hexagon (6)", {
			{ -0.5, cos30, 0, "1"},
			{ 0.5, cos30, 0, "2"},
			{ 1, 0, 0, "3"},
			{ 0.5, -cos30, 0, "4"},
			{ -0.5, -cos30, 0, "5"},
			{ -1, 0, 0, "6"}
			});

		createPreset("ICST Kompositionsstudio", {
			{ -1.74474, 4.31839, 0, "1"},
			{ 1.78236, 4.303, 0, "2"},
			{ 3.9866, 1.65131, 0, "3"},
			{ 4.02457, -1.66703, 0, "4"},
			{ 1.81906, -4.39159, 0, "5"},
			{ -1.84527, -4.45487, 0, "6"},
			{ -3.91067, -1.61985, 0, "7"},
			{ -4.01192, 1.66179, 0, "8"},
			{ -2.00185, 1.95353, 3.32164, "9"},
			{ 2.19268, 2.00922, 3.34973, "10"},
			{ 2.29422, -1.98032, 3.35414, "11"},
			{ -1.91004, -2.05545, 3.33212, "12"},
			{ 0.23209, -0.09283, 4.33527, "13"},
			{ 4.13814, 4.36069, -1.23401, "14"},
			{ 4.25756, -4.33253, -1.269, "15"},
			{ -3.94811, -4.50989, -1.25219, "16"},
			{ -3.95405, 4.26999, -1.21577, "17"}
			});

		createPreset("Dolby LRCS", {
			{ -0.5, cos30, 0, "L"},
			{ 0.5, cos30, 0, "R"},
			{ 0, 1, 0, "C"},
			{ 0, -1, 0, "SB"}
			});

		createPreset("Regular 2D - Octagon (8)", {
			{ -0.382683, 0.92388, 0, "1"},
			{ 0.382683, 0.92388, 0, "2"},
			{ 0.92388, 0.382683, 0, "3"},
			{ 0.92388, -0.382683, 0, "4"},
			{ 0.382683, -0.92388, 0, "5"},
			{ -0.382683, -0.92388, 0, "6"},
			{ -0.92388, -0.382683, 0, "7"},
			{ -0.92388, 0.382683, 0, "8"}
			});
        
        createPreset("Regular 2D - Centered Octagon (8)", {
            { 0.0, 1.0, 0.0, "1" },
            { 0.7071067811865475, 0.7071067811865476, 0.0, "2" },
            { 1.0, 0.0, 0.0, "3" },
            { 0.7071067811865476, -0.7071067811865475, 0.0, "4" },
            { 0.0, -1.0, 0.0, "5" },
            { -0.7071067811865475, -0.7071067811865477, 0.0, "6" },
            { -1.0, 0.0, 0.0, "7" },
            { -0.7071067811865477, 0.7071067811865475, 0.0, "8" }
            });
            
		createPreset("Regular 2D - Quadro (4)", {
			{ -sin45, sin45, 0, "L"},
			{ sin45, sin45, 0, "R"},
			{ -sin45, -sin45, 0, "SBL"},
			{ sin45, -sin45, 0, "SBR"},
			});

		createPreset("Regular 2D - Square (4)", {
			{ -sin45, sin45, 0, "1"},
			{ sin45, sin45, 0, "2"},
			{ sin45, -sin45, 0, "3"},
			{ -sin45, -sin45, 0, "4"},
			});

		createPreset("Regular 3D - Square (5)", {
			{ -sin45, sin45, 0, "1"},
			{ sin45, sin45, 0, "2"},
			{ sin45, -sin45, 0, "3"},
			{ -sin45, -sin45, 0, "4"},
			{ 0, 0, 1, "T", false, 1},
			});

        createPreset("Standard - Mono", {
            { 0, 1, 0, "Mono"},
            });

        createPreset("Standard - Stereo 15deg", {
			{ -0.258819, 0.965926, 0, "L"},
			{ 0.258819, 0.965926, 0, "R"},
			});

		createPreset("Standard - Stereo 30deg", {
			{ -0.5, cos30, 0, "L"},
			{ 0.5, cos30, 0, "R"},
			});

		createPreset(DEFAULT_PRESET_NAME, {
			{ -1, 0, 0, "L"},
			{ 1, 0, 0, "R"},
			});

		createPreset("Standard - Stereo 45deg", {
			{ -sin45, sin45, 0, "L"},
			{ sin45, sin45, 0, "R"},
			});
        
        createPreset("Auro 3D 9.1", {
            { -0.7, 0.7, 0.0, "Left" },
            { 0.7071067811865475, 0.7071067811865476, 0.0, "Right" },
            { 0.0, 1.0, 0.0, "C" },
            { -0.06, -1.0, -0.1, "Sub", true },
            { -1.0, -6.0, 0.0, "BL" },
            { 1.0, -0.57, 0.0, "BR" },
            { -0.7, 0.7, 0.7, "UFL", false, 1},
            { 0.7, 0.7, 0.7, "UFR", false, 1},
            { -1.0, -0.57, 0.7, "UBL", false, 1},
            { 1.0, -0.6, 0.7, "UBR", false, 1}
            });
        
        createPreset("ZHdK IA Space", {
            { -2.800432873700518, 5.036593941550021, -1.669159809358996, "1" },
            { 2.723139663172596, 5.109035437143638, -1.647832464370185, "2" },
            { 4.878091548147448, 3.746254541670719, -1.638174160677705, "3" },
            { 4.876075050079993, -0.1422375893040261, -1.6497184796468, "4" },
            { 4.9054319296526, -3.613753522148266, -1.653684949835577, "5" },
            { 2.589833275799082, -5.350000000000001, -1.649476090407373, "6" },
            { -2.576755018217618, -5.265418299746907, -1.688129832888262, "7" },
            { -4.867578067332546, -3.622636077724777, -1.592200174679043, "8" },
            { -4.835262919698596, -0.1728470002122816, -1.604499099596146, "9" },
            { -4.900898455855864, 3.714241555505657, -1.655614649826064, "10" },
            { 0.0, 5.141810394287435, 0.01689471818042556, "11" , false, 2 },
            { 4.876265687401228, 4.954857391850978, 0.3542355052822184, "12", false, 2 },
            { 4.874720642810457, 1.815066948540041, 0.3028065479962574, "13", false, 2 },
            { 4.88174044101799, -2.095469846161746, 0.3152252789372967, "14", false, 2 },
            { 5.0, -5.330687632039765, 0.3118644663916865, "15", false, 2 },
            { 0.1242281637173356, -5.227637725768071, 0.1202558210623863, "16", false, 2 },
            { -4.829651158359075, -5.319462549751924, 0.3384225640850375, "17", false, 2 },
            { -4.818564679288066, -2.10314773407526, 0.3479251972117167, "18", false, 2 },
            { -4.863258420404241, 1.773144307176552, 0.3343921713713145, "19", false, 2 },
            { -4.870613412905037, 4.961475127270074, 0.3544501562982307, "20", false, 2 },
            { -2.89070851943873, 5.133279432607838, 3.359838043747735, "21", false, 3 },
            { 2.559299245860239, 5.156771925203882, 3.329941947546854, "22", false, 3 },
            { 4.843292618197443, 3.77725889934886, 3.548985716165751, "23", false, 3 },
            { 4.85647679324064, -0.1286209868591434, 3.567116384466961, "24", false, 3 },
            { 4.892035741419885, -3.602618028502029, 3.579239304756083, "25", false, 3 },
            { 2.543145557228299, -5.221852040676716, 3.492971481413631, "26", false, 3 },
            { -2.596013106571062, -5.236974157579661, 3.463995480384232, "27", false, 3 },
            { -4.782969004921267, -3.649264543595071, 3.581910567992448, "28", false, 3 },
            { -4.804654041540904, -0.1445486917969484, 3.574309481056051, "29", false, 3 },
            { -4.840705585769722, 3.744604987071859, 3.54383756849811, "30", false, 3 },
            { -0.1583492990090341, 4.544026765587351, 5.358252811855502, "31", false, 1 },
            { 2.632613969770838, 2.203541914954306, 5.339594367774414, "32", false, 1 },
            { 2.55865044542694, -2.610389767537267, 5.307100952827715, "33", false, 1 },
            { -0.108865394453826, -4.633224917475532, 5.364208642517243, "34", false, 1 },
            { -2.658646195871896, -2.598636523867603, 5.336135883737099, "35", false, 1 },
            { -2.615307269475431, 2.206468499581705, 5.330739319071638, "36", false, 1 },
            { 0.130264331294197, 0.1824089445755624, 5.4, "37", false, 1 },
            { 0.0, 6.577848345501359, -2.394141003279681, "S1", true },
            { 6.40415471125752, 1.488532817542229, -2.402305660272628, "S2", true },
            { 0.0, -6.577848345501359, -2.394141003279681, "S3", true },
            { -6.324496744828188, -1.553385093649427, -2.566658464908296, "S4", true }
        });
        
        createPreset("ICST Kompositionsstudio", {
            { -1.84409145144167, 4.308919951484405, 0.0, "1" },
            { 1.883853662661243, 4.293563701110227, 0.0, "2" },
            { 4.213610612651378, 1.647688746288712, 0.0, "3" },
            { 4.253742754065708, -1.663374272986702, 0.0, "4" },
            { 1.922643485940304, -4.381959426948329, 0.0, "5" },
            { -1.950345972810718, -4.445100656557034, 0.0, "6" },
            { -4.133356899256851, -1.616297736751894, 0.0, "7" },
            { -4.240372419883689, 1.658145764087372, 0.0, "8" },
            { -2.115842172511955, 1.949245990478704, 3.064759519014963, "9", false, 1 },
            { 2.317538684128938, 2.004813864639714, 3.090677166589394, "10", false, 1 },
            { 2.424860718345719, -1.97597724113005, 3.094746117312186, "11", false, 1 },
            { -2.018804197709486, -2.050942484184759, 3.074429043635114, "12", false, 1 },
            { -4.179428285727545, 4.260894027488713, -1.121824536623947, "13", false, 2 },
            { 4.373779817548079, 4.351127189354951, -1.138577297377095, "14", false, 2 },
            { 4.5, -4.323028943056261, -1.170861330436167, "15", false, 2 },
            { -4.172928860661976, -4.5, -1.15535133913228, "16", false, 2 },
            { 0.2453624541908279, -0.09264623796020273, 4.00041184638098, "17", false, 3 },
            { -0.5510707332078513, 4.959638839272439, -1.816269687574834, "SUB", true }
        });

        createPreset("Notam Studio 3", {
            { 0.0, 1.948, 0.0, "1" },
            { 0.9804999999999999, 1.698275816821284, 0.0, "2" },
            { 1.700007867628853, 0.9815000000000003, 0.0, "3" },
            { 1.873, 0.0, 0.0, "4" },
            { 1.714730299493189, -0.9899999999999995, 0.0, "5" },
            { 0.9879999999999999, -1.711266197878051, 0.0, "6" },
            { 0.0, -1.948, 0.0, "7" },
            { -0.9704999999999996, -1.680955308745596, 0.0, "8" },
            { -1.687017486572085, -0.9740000000000023, 0.0, "9" },
            { -1.791, 0.0, 0.0, "10" },
            { -1.654974546632062, 0.9555, 0.0, "11" },
            { -0.9625000000000009, 1.667098902285044, 0.0, "12" },
            { 0.6155131526843163, 1.485980201029498, 1.097185217281452, "13", false, 1 },
            { 1.473284603960444, 0.61025446419589, 1.108325748443166, "14", false, 1 },
            { 1.483146962277378, -0.6143395867677471, 1.115745024823064, "15", false, 1 },
            { 0.6141400036713286, -1.482665126059183, 1.111233629737008, "16", false, 1 },
            { -0.6137111063720748, -1.481629676382466, 1.114603597687695, "17", false, 1 },
            { -1.48698299664716, -0.6159285242294399, 1.093814253300246, "18", false, 1 },
            { -1.490274533952546, 0.6172919236223887, 1.092124761409195, "19", false, 1 },
            { -0.6137283874452174, 1.481671396583614, 1.102226537055725, "20", false, 1 },
            { 0.5372943135904125, 0.5372943135904126, 1.484874958091359, "21", false, 2 },
            { 0.527794683410278, -0.5277946834102779, 1.490555112811227, "22", false, 2 },
            { -0.4927220963387746, -0.4927220963387752, 1.501157843652374, "23", false, 2 },
            { -0.5194491510559323, 0.5194491510559321, 1.486374501575744, "24", false, 2 }
        });
        
        createPreset("ICST DOM Sub", {
            { -0.03757412367220234, 0.98979091745321, -0.1374849990267985, "1", false, 2 },
            { 0.517107850154924, 0.8167270975439532, -0.2560396833414357, "2" },
            { 0.8372646584443071, 0.5292312979810803, 0.1374849990267985, "3" },
            { 0.9897910486056143, 0.03757066864989003, -0.1374849990267985, "4" },
            { 0.8167252924920626, -0.5171107010671621, -0.2560396833414357, "5" },
            { 0.5292342205828561, -0.8372628110734754, 0.1374849990267985, "6" },
            { 0.03757412367220222, -0.98979091745321, -0.1374849990267985, "7" },
            { -0.5171107010671624, -0.8167252924920625, -0.2560396833414357, "8" },
            { -0.8372628110734754, -0.5292342205828559, 0.1374849990267985, "9" },
            { -0.98979091745321, -0.03757412367220139, -0.1374849990267985, "10" },
            { -0.816725292492063, 0.5171107010671616, -0.2560396833414357, "11" },
            { -0.5292342205828566, 0.8372628110734749, 0.1374849990267985, "12" },
            { -0.08676274826602477, 0.8649732735441314, 0.4942605199362736, "13", false, 1 },
            { 0.3806490757959952, 0.8885662393148145, 0.2560396833414357, "14", false, 1  },
            { 0.5083527087110327, 0.5475354039585533, 0.664667213692762, "15", false, 1  },
            { 0.8649728192435873, 0.08676727725430503, 0.4942605199362736, "16", false, 1  },
            { 0.8885635818612939, -0.3806552791493182, 0.2560396833414357, "17", false, 1  },
            { 0.5475336294695118, -0.5083546199670499, 0.664667213692762, "18", false, 1  },
            { 0.08676274826602544, -0.8649732735441314, 0.4942605199362736, "19", false, 1  },
            { -0.3806552791493182, -0.8885635818612937, 0.2560396833414357, "20", false, 1  },
            { -0.5083546199670493, -0.547533629469512, 0.664667213692762, "21", false, 1  },
            { -0.8649732735441314, -0.08676274826602472, 0.4942605199362736, "22", false, 1 },
            { -0.8885635818612939, 0.3806552791493178, 0.2560396833414357, "23", false, 1  },
            { -0.5475336294695118, 0.5083546199670497, 0.664667213692762, "24", false, 1  },
            { 0.0, 0.4735318207773393, 0.8807767110404869, "25", false, 2 },
            { 0.4735318207773393, 0.0, 0.8807767110404869, "26", false, 2 },
            { 0.0, -0.4735318207773393, 0.8807767110404869, "27", false, 2 },
            { -0.4735318207773393, 0.0, 0.8807767110404869, "28", false, 2 },
            { 0.0, 0.0, 0.9999999999999999, "29", false, 3 },
            { -0.6503045928584846, 0.6776858606079516, -0.5422650610051567, "30", true },
            { 0.6708405436705849, 0.6982218114200522, -0.559029138469825, "31", true },
            { 0.6776858606079518, -0.6571499097958512, -0.5450089080656191, "32", true },
            { -0.6845311775453184, -0.6571499097958515, -0.5478530633227233, "33", true }
        });
        
		notifyPresetListChanged();
    }
    
    void loadDefaultPreset(AmbiSpeakerSet* pSpeakerSet, AmbiSettings* pAmbiSettings)
    {
        for(File f : presetFiles)
        {
            if(f.getFileNameWithoutExtension() == DEFAULT_PRESET_NAME)
            {
                loadFromXmlFile(f, pSpeakerSet, pAmbiSettings);
                break;
            }
        }
    }
    
    bool loadFromXmlFile(const File file, AmbiSpeakerSet* pSpeakerSet, AmbiSettings* pAmbiSettings)
    {
        XmlDocument doc(file);
        std::unique_ptr<XmlElement> rootElement = doc.getDocumentElementIfTagMatches("AmbisonicsPreset");

        if (rootElement == nullptr || rootElement->getTagName() != "AmbisonicsPreset")
            return false;
        
        pSpeakerSet->loadFromXml(rootElement.get());
        pAmbiSettings->loadFromPresetXml(rootElement->getChildByName("General"));

        return pSpeakerSet->size() > 0;
    }
    
    bool writeToXmlFile(const File file, AmbiSpeakerSet* pSpeakerSet, AmbiSettings* pAmbiSettings)
    {
        XmlElement* rootElement = new XmlElement("AmbisonicsPreset");

        pSpeakerSet->writeToXmlElement(rootElement);
        
        XmlElement* xmlSettings = new XmlElement("General");
        pAmbiSettings->writeToPresetXmlElement(xmlSettings);
        rootElement->addChildElement(xmlSettings);

        bool success = rootElement->writeTo(file);
        delete rootElement;
        return success;
    }
    
    AmbiSettings getDefaultAmbiSettings()
    {
        AmbiSettings settings;
        
        settings.setWeightMode(AmbiSettings::INPHASE);
            
        return settings;
    }
    
    void createPreset(String name, std::initializer_list<SSpeaker> speakerList)
    {
        AmbiSettings defaultAmbiSettings = getDefaultAmbiSettings();
        std::unique_ptr<AmbiSpeakerSet> speakerSet(new AmbiSpeakerSet(pScalingInfo));

        File file = getPathForPresetName(name);

        for (const SSpeaker& speaker : speakerList)
        {
            Colour color;
            switch(speaker.colorIndex)
            {
                case 1:
                    color = TrackColors::getSpeakerColorAlt1();
                    break;
                case 2:
                    color = TrackColors::getSpeakerColorAlt2();
                    break;
                case 3:
                    color = TrackColors::getSpeakerColorAlt3();
                    break;
                default:
                    color = TrackColors::getSpeakerColor();
                    break;
            }
            
            speakerSet->addNew(Uuid().toString(), Point3D<double>(speaker.x, speaker.y, speaker.z), speaker.name, color);
            if(speaker.isSubwoofer)
            {
				auto s = speakerSet->get(speakerSet->size() - 1);
				auto f = s->getFilterInfo()->get(0);
				s->setFilterBypass(false);
				s->setGain(Decibels::decibelsToGain(-6.0), false);
				s->setColor(TrackColors::getSubwooferColor());
                f->filterType = FilterInfo::LowPass;
                f->cutOffFrequencyHz = 35;
                f->qValue = 0.75;
            }
        }
        
        writeToXmlFile(file, speakerSet.get(), &defaultAmbiSettings);
        presetFiles.addIfNotAlreadyThere(file);
    }
    
private:
    ScalingInfo* pScalingInfo;
};
